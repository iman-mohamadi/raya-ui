{
  "name": "snow-effect",
  "type": "registry:ui",
  "dependencies": [
    "@vueuse/core"
  ],
  "files": [
    {
      "path": "snow-effect/SnowEffect.vue",
      "content": "<script setup lang=\"ts\">\r\nimport { onMounted, onBeforeUnmount, ref, reactive, computed } from \"vue\";\r\nimport { useDevicePixelRatio } from \"@vueuse/core\";\r\nimport { cn } from \"@/lib/utils\";\r\n\r\ntype Snowflake = {\r\n  x: number;\r\n  y: number;\r\n  size: number;\r\n  alpha: number;\r\n  dx: number; // Horizontal drift\r\n  dy: number; // Vertical fall speed\r\n};\r\n\r\ntype Props = {\r\n  color?: string;\r\n  quantity?: number;\r\n  speed?: number;\r\n  maxRadius?: number;\r\n  minRadius?: number;\r\n  class?: string;\r\n};\r\n\r\nconst props = withDefaults(defineProps<Props>(), {\r\n  color: \"#FFF\",\r\n  quantity: 100,\r\n  speed: 1, // Controls how fast the snowflakes fall\r\n  maxRadius: 3, // Default max radius\r\n  minRadius: 1, // Default min radius\r\n  class: \"\",\r\n});\r\n\r\nconst canvasRef = ref<HTMLCanvasElement | null>(null);\r\nconst canvasContainerRef = ref<HTMLDivElement | null>(null);\r\nconst context = ref<CanvasRenderingContext2D | null>(null);\r\nconst snowflakes = ref<Snowflake[]>([]);\r\nconst canvasSize = reactive<{ w: number; h: number }>({ w: 0, h: 0 });\r\nconst { pixelRatio } = useDevicePixelRatio();\r\n\r\nconst color = computed(() => {\r\n  const hex = props.color.replace(/^#/, \"\").padStart(6, \"0\");\r\n  const bigint = parseInt(hex, 16);\r\n  const r = (bigint >> 16) & 255;\r\n  const g = (bigint >> 8) & 255;\r\n  const b = bigint & 255;\r\n  return `${r} ${g} ${b}`;\r\n});\r\n\r\nonMounted(() => {\r\n  if (canvasRef.value) {\r\n    context.value = canvasRef.value.getContext(\"2d\");\r\n  }\r\n  initCanvas();\r\n  animate();\r\n  window.addEventListener(\"resize\", initCanvas);\r\n});\r\n\r\nonBeforeUnmount(() => {\r\n  window.removeEventListener(\"resize\", initCanvas);\r\n});\r\n\r\nfunction initCanvas() {\r\n  resizeCanvas();\r\n  createSnowflakes();\r\n}\r\n\r\nfunction resizeCanvas() {\r\n  if (canvasContainerRef.value && canvasRef.value && context.value) {\r\n    snowflakes.value.length = 0;\r\n    canvasSize.w = canvasContainerRef.value.offsetWidth;\r\n    canvasSize.h = canvasContainerRef.value.offsetHeight;\r\n    canvasRef.value.width = canvasSize.w * pixelRatio.value;\r\n    canvasRef.value.height = canvasSize.h * pixelRatio.value;\r\n    canvasRef.value.style.width = `${canvasSize.w}px`;\r\n    canvasRef.value.style.height = `${canvasSize.h}px`;\r\n    context.value.scale(pixelRatio.value, pixelRatio.value);\r\n  }\r\n}\r\n\r\nfunction createSnowflakes() {\r\n  for (let i = 0; i < props.quantity; i++) {\r\n    const snowflake = createSnowflake();\r\n    snowflakes.value.push(snowflake);\r\n  }\r\n}\r\n\r\nfunction createSnowflake(): Snowflake {\r\n  const x = Math.random() * canvasSize.w;\r\n  const y = Math.random() * canvasSize.h;\r\n  const size = Math.random() * (props.maxRadius! - props.minRadius!) + props.minRadius!; // Random size between min and max radius\r\n  const alpha = Math.random() * 0.5 + 0.5; // Opacity between 0.5 and 1\r\n  const dx = (Math.random() - 0.5) * 0.5; // Slight horizontal drift\r\n  const dy = Math.random() * 0.25 + props.speed; // Falling speed\r\n\r\n  return { x, y, size, alpha, dx, dy };\r\n}\r\n\r\nfunction drawSnowflake(snowflake: Snowflake) {\r\n  if (context.value) {\r\n    const { x, y, size, alpha } = snowflake;\r\n    context.value.beginPath();\r\n    context.value.arc(x, y, size, 0, Math.PI * 2);\r\n    context.value.fillStyle = `rgba(${color.value.split(\" \").join(\", \")}, ${alpha})`;\r\n    context.value.fill();\r\n  }\r\n}\r\n\r\nfunction animate() {\r\n  if (context.value) {\r\n    context.value.clearRect(0, 0, canvasSize.w, canvasSize.h);\r\n  }\r\n\r\n  snowflakes.value.forEach((snowflake) => {\r\n    snowflake.x += snowflake.dx; // Drift horizontally\r\n    snowflake.y += snowflake.dy; // Fall down\r\n\r\n    // Reset snowflake when it moves out of the canvas\r\n    if (snowflake.y > canvasSize.h) {\r\n      snowflake.y = -snowflake.size; // Reset to the top\r\n      snowflake.x = Math.random() * canvasSize.w; // Random horizontal position\r\n    }\r\n\r\n    drawSnowflake(snowflake);\r\n  });\r\n\r\n  requestAnimationFrame(animate);\r\n}\r\n</script>\r\n\r\n<template>\r\n  <div\r\n      ref=\"canvasContainerRef\"\r\n      :class=\"cn('pointer-events-none absolute inset-0', props.class)\"\r\n      aria-hidden=\"true\"\r\n  >\r\n    <canvas ref=\"canvasRef\"></canvas>\r\n  </div>\r\n</template>",
      "type": "registry:ui"
    },
    {
      "path": "snow-effect/index.ts",
      "content": "export { default as SnowEffect } from './SnowEffect.vue'\n",
      "type": "registry:ui"
    }
  ]
}